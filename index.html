<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSL 색채 맞추기 </title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        #targetColor, #userColor {
            width: 100px;
            height: 100px;
            margin: 10px auto;
        }
        .slider-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }
        .slider-label {
            width: 50px;
            text-align: right;
            margin-right: 10px;
        }
        .slider {
            width: 300px;
        }
        .number-input {
            width: 60px;
            margin-left: 10px;
        }
        .info-text {
            font-size: 0.9em;
            color: #666;
        }
        #colorWheel {
            margin: 20px auto;
            cursor: crosshair;
        }
        #colorDisplay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            border: 5px solid #fff;
        }
    </style>
</head>
<body>
    <h1>HSL 색채 맞추기</h1>
    <div id="targetColor"></div>
    <p>주어진 색채의 HSL 값을 맞춰보세요!</p>

    <canvas id="colorWheel" width="300" height="300"></canvas>
    <div class="slider-container">
        <label for="hueSlider" class="slider-label">Hue</label>
        <input type="range" id="hueSlider" class="slider" min="0" max="360">
        <input type="number" id="hueNumber" class="number-input" min="0" max="360">
    </div>
    <p class="info-text">Hue는 0-360의 범위 내에서 조정할 수 있습니다.</p>
    
    <div class="slider-container">
        <label for="saturationSlider" class="slider-label">Saturation</label>
        <input type="range" id="saturationSlider" class="slider" min="0" max="100">
        <input type="number" id="saturationNumber" class="number-input" min="0" max="100">
    </div>
    <div class="slider-container">
        <label for="lightnessSlider" class="slider-label">Lightness</label>
        <input type="range" id="lightnessSlider" class="slider" min="0" max="100">
        <input type="number" id="lightnessNumber" class="number-input" min="0" max="100">
    </div>
    <p class="info-text">Saturation과 Lightness는 0-100 범위 내에서 조정할 수 있습니다.</p>
    
    <div id="userColor"></div>
    <p id="resultText"></p>
    <button onclick="checkColor()">Check Color</button>
    <button onclick="showAnswer()">Answer Sheet</button>
    
    <p id="answerText"></p>

    <script>
        let targetColor = {
            h: Math.floor(Math.random() * 361),
            s: Math.floor(Math.random() * 101),
            l: Math.floor(Math.random() * 101)
        };

        let userColor = { h: 0, s: 100, l: 50 };

        document.getElementById('targetColor').style.backgroundColor = `hsl(${targetColor.h}, ${targetColor.s}%, ${targetColor.l}%)`;

        function drawColorWheel() {
            const canvas = document.getElementById('colorWheel');
            const ctx = canvas.getContext('2d');
            const radius = canvas.width / 2;

            for (let angle = 0; angle < 360; angle++) {
                const startAngle = (angle - 90) * Math.PI / 180;
                const endAngle = (angle - 89) * Math.PI / 180;

                ctx.beginPath();
                ctx.moveTo(radius, radius);
                ctx.arc(radius, radius, radius, startAngle, endAngle, false);
                ctx.closePath();
                ctx.fillStyle = `hsl(${angle}, 100%, 50%)`;
                ctx.fill();
            }

            // 가운데의 큰 원을 제거하고 중심점을 점으로 표현
            ctx.beginPath();
            ctx.arc(radius, radius, 5, 0, Math.PI * 2, false);
            ctx.closePath();
            ctx.fillStyle = "#fff";
            ctx.fill();
        }

        function updateUserColor() {
            userColor.h = document.getElementById('hueSlider').value;
            userColor.s = document.getElementById('saturationSlider').value;
            userColor.l = document.getElementById('lightnessSlider').value;
            document.getElementById('userColor').style.backgroundColor = `hsl(${userColor.h}, ${userColor.s}%, ${userColor.l}%)`;

            drawColorWheel();
        }

        function syncSlidersAndNumbers(sliderId, numberId) {
            let slider = document.getElementById(sliderId);
            let numberInput = document.getElementById(numberId);

            slider.addEventListener('input', function() {
                numberInput.value = slider.value;
                updateUserColor();
            });

            numberInput.addEventListener('input', function() {
                slider.value = numberInput.value;
                updateUserColor();
            });
        }

        syncSlidersAndNumbers('hueSlider', 'hueNumber');
        syncSlidersAndNumbers('saturationSlider', 'saturationNumber');
        syncSlidersAndNumbers('lightnessSlider', 'lightnessNumber');

        document.getElementById('colorWheel').addEventListener('click', function(event) {
            const rect = this.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;

            const radius = this.width / 2;
            const dx = x - radius;
            const dy = y - radius;
            const distance = Math.sqrt(dx * dx + dy * dy);

            if (distance <= radius && distance >= 0) {
                const angle = Math.atan2(dy, dx) * (180 / Math.PI) + 180;
                const saturation = Math.min(Math.max((distance / radius) * 100, 0), 100);

                userColor.h = Math.round(angle);
                userColor.s = Math.round(saturation);

                document.getElementById('hueSlider').value = userColor.h;
                document.getElementById('saturationSlider').value = userColor.s;

                document.getElementById('hueNumber').value = userColor.h;
                document.getElementById('saturationNumber').value = userColor.s;

                updateUserColor();
            }
        });

        function checkColor() {
            let hDiff = targetColor.h - userColor.h;
            let sDiff = targetColor.s - userColor.s;
            let lDiff = targetColor.l - userColor.l;

            let totalDiff = Math.abs(hDiff) + Math.abs(sDiff) + Math.abs(lDiff);

            let resultText = `Difference: Hue(${hDiff > 0 ? '+' + hDiff : hDiff}), Saturation(${sDiff > 0 ? '+' + sDiff : sDiff}), Lightness(${lDiff > 0 ? '+' + lDiff : lDiff})`;

            if (totalDiff === 0) {
                resultText = "PERFECT!";
            } else if (Math.abs(hDiff) <= 10 && Math.abs(sDiff) <= 10 && Math.abs(lDiff) <= 10) {
                resultText = "GOOD!";
            }
            
            document.getElementById('resultText').innerText = resultText;
        }

        function showAnswer() {
            let answerText = `Target HSL: (${targetColor.h}, ${targetColor.s}%, ${targetColor.l}%)\nYour HSL: (${userColor.h}, ${userColor.s}%, ${userColor.l}%)`;
            document.getElementById('answerText').innerText = answerText;
        }

        drawColorWheel();
        updateUserColor();
    </script>
</body>
</html>
